#!/usr/bin/env python
# -*- coding: utf-8 -*-
# author： Gz
# datetime： 2021/11/4 12:17 
vgg16 = {"features": 30, "classifier": 7}
alexnet = {"features": 12, "classifier": 7}


def vgg16_config():
    features = vgg16['features']
    classifiers = vgg16['classifier']
    classifiers_index = {31: 0, 32: 1, 33: 2, 34: 3, 35: 4, 36: 5, 37: 6, 38: 7}
    return features, classifiers, classifiers_index


def alexnet_config():
    features = alexnet['features']
    classifiers = alexnet['classifier']
    classifiers_index = {13: 0, 14: 1, 15: 2, 16: 3, 17: 4, 18: 5, 19: 6, 20: 7}
    return features, classifiers, classifiers_index


def alexnet_layer_config(imgSize):
    if imgSize == 224:
        input_data_sizes = [0.1435546875, 0.5742721557617188, 0.7385787963867188, 0.7385787963867188,
                            0.17803192138671875, 0.5339889526367188, 0.5339889526367188, 0.12383270263671875,
                            0.24761199951171875, 0.24761199951171875, 0.16509246826171875, 0.16509246826171875,
                            0.16509246826171875, 0.16509246826171875, 0.03520965576171875, 0.03520965576171875,
                            0.03520965576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                            0.01567840576171875, 0.01567840576171875]
        output_data_sizes = [0.1435546875, 0.7385787963867188, 0.7385787963867188, 0.17803192138671875,
                             0.5339889526367188, 0.5339889526367188, 0.12383270263671875, 0.24761199951171875,
                             0.24761199951171875, 0.16509246826171875, 0.16509246826171875, 0.16509246826171875,
                             0.16509246826171875, 0.03520965576171875, 0.03520965576171875, 0.03520965576171875,
                             0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                             0.01567840576171875, 0.00386810302734375]
        input_shapes = [150528, 193600, 193600, 46656, 139968, 139968, 32448, 64896, 64896, 43264, 43264, 43264, 43264,
                        9216, 9216, 9216, 4096, 4096, 4096, 4096, 4096]
        output_shapes = [193600, 193600, 46656, 139968, 139968, 32448, 64896, 64896, 43264, 43264, 43264, 43264, 9216,
                         9216, 9216, 4096, 4096, 4096, 4096, 4096, 1000]
    elif imgSize == 300:
        input_data_sizes = [0.2574920654296875, 1.0300216674804688, 1.3369674682617188, 1.3369674682617188,
                            0.31645965576171875, 0.9492721557617188, 0.9492721557617188, 0.21172332763671875,
                            0.42339324951171875, 0.42339324951171875, 0.28227996826171875, 0.28227996826171875,
                            0.28227996826171875, 0.28227996826171875, 0.06255340576171875, 0.03520965576171875,
                            0.03520965576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                            0.01567840576171875, 0.01567840576171875]
        output_data_sizes = [0.2574920654296875, 1.3369674682617188, 1.3369674682617188, 0.31645965576171875,
                             0.9492721557617188, 0.9492721557617188, 0.21172332763671875, 0.42339324951171875,
                             0.42339324951171875, 0.28227996826171875, 0.28227996826171875, 0.28227996826171875,
                             0.28227996826171875, 0.06255340576171875, 0.03520965576171875, 0.03520965576171875,
                             0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                             0.01567840576171875, 0.00386810302734375]
        input_shapes = [270000, 350464, 350464, 82944, 248832, 248832, 55488, 110976, 110976, 73984, 73984, 73984,
                        73984,
                        16384, 9216, 9216, 4096, 4096, 4096, 4096, 4096]
        output_shapes = [350464, 350464, 82944, 248832, 248832, 55488, 110976, 110976, 73984, 73984, 73984, 73984,
                         16384,
                         9216, 9216, 4096, 4096, 4096, 4096, 4096, 1000]
    elif imgSize == 400:
        input_data_sizes = [0.457763671875, 1.8311080932617188, 2.3928756713867188, 2.3928756713867188,
                            0.5862350463867188, 1.7585983276367188, 1.7585983276367188, 0.42192840576171875,
                            0.8438034057617188, 0.8438034057617188, 0.5625534057617188, 0.5625534057617188,
                            0.5625534057617188, 0.5625534057617188, 0.11821746826171875, 0.03520965576171875,
                            0.03520965576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                            0.01567840576171875, 0.01567840576171875]
        output_data_sizes = [0.457763671875, 2.3928756713867188, 2.3928756713867188, 0.5862350463867188,
                             1.7585983276367188, 1.7585983276367188, 0.42192840576171875, 0.8438034057617188,
                             0.8438034057617188, 0.5625534057617188, 0.5625534057617188, 0.5625534057617188,
                             0.5625534057617188, 0.11821746826171875, 0.03520965576171875, 0.03520965576171875,
                             0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                             0.01567840576171875, 0.00386810302734375]
        input_shapes = [480000, 627264, 627264, 153664, 460992, 460992, 110592, 221184, 221184, 147456, 147456, 147456,
                        147456, 30976, 9216, 9216, 4096, 4096, 4096, 4096, 4096]
        output_shapes = [627264, 627264, 153664, 460992, 460992, 110592, 221184, 221184, 147456, 147456, 147456, 147456,
                         30976, 9216, 9216, 4096, 4096, 4096, 4096, 4096, 1000]
    elif imgSize == 500:
        input_data_sizes = [0.7152557373046875, 2.8610763549804688, 3.7539596557617188, 3.7539596557617188,
                            0.9085006713867188, 2.7253952026367188, 2.7253952026367188, 0.6592330932617188,
                            1.3184127807617188, 1.3184127807617188, 0.8789596557617188, 0.8789596557617188,
                            0.8789596557617188, 0.8789596557617188, 0.19145965576171875, 0.03520965576171875,
                            0.03520965576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                            0.01567840576171875, 0.01567840576171875]
        output_data_sizes = [0.7152557373046875, 3.7539596557617188, 3.7539596557617188, 0.9085006713867188,
                             2.7253952026367188, 2.7253952026367188, 0.6592330932617188, 1.3184127807617188,
                             1.3184127807617188, 0.8789596557617188, 0.8789596557617188, 0.8789596557617188,
                             0.8789596557617188, 0.19145965576171875, 0.03520965576171875, 0.03520965576171875,
                             0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                             0.01567840576171875, 0.00386810302734375]
        input_shapes = [750000, 984064, 984064, 238144, 714432, 714432, 172800, 345600, 345600, 230400, 230400, 230400,
                        230400, 50176, 9216, 9216, 4096, 4096, 4096, 4096, 4096]
        output_shapes = [984064, 984064, 238144, 714432, 714432, 172800, 345600, 345600, 230400, 230400, 230400, 230400,
                         50176, 9216, 9216, 4096, 4096, 4096, 4096, 4096, 1000]
    elif imgSize == 640:
        input_data_sizes = [1.171875, 4.687553405761719, 6.172172546386719, 6.172172546386719, 1.5237350463867188,
                            4.571098327636719, 4.571098327636719, 1.1140670776367188, 2.2280807495117188,
                            2.2280807495117188, 1.4854049682617188, 1.4854049682617188, 1.4854049682617188,
                            1.4854049682617188, 0.35259246826171875, 0.03520965576171875, 0.03520965576171875,
                            0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                            0.01567840576171875]
        output_data_sizes = [1.171875, 6.172172546386719, 6.172172546386719, 1.5237350463867188, 4.571098327636719,
                             4.571098327636719, 1.1140670776367188, 2.2280807495117188, 2.2280807495117188,
                             1.4854049682617188, 1.4854049682617188, 1.4854049682617188, 1.4854049682617188,
                             0.35259246826171875, 0.03520965576171875, 0.03520965576171875, 0.01567840576171875,
                             0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                             0.00386810302734375]
        input_shapes = [1228800, 1617984, 1617984, 399424, 1198272, 1198272, 292032, 584064, 584064, 389376, 389376,
                        389376, 389376, 92416, 9216, 9216, 4096, 4096, 4096, 4096, 4096]
        output_shapes = [1617984, 1617984, 399424, 1198272, 1198272, 292032, 584064, 584064, 389376, 389376, 389376,
                         389376, 92416, 9216, 9216, 4096, 4096, 4096, 4096, 4096, 1000]
    else:
        input_data_sizes, output_data_sizes, input_shapes, output_shapes = [], [], [], []

    return input_data_sizes, output_data_sizes, input_shapes, output_shapes


def vgg16_layer_config(imgSize):
    if imgSize == 224:
        input_data_sizes = [0.1435546875, 0.5742721557617188, 12.250053405761719, 12.250053405761719,
                            12.250053405761719,
                            12.250053405761719, 3.0625534057617188, 6.125053405761719, 6.125053405761719,
                            6.125053405761719, 6.125053405761719, 1.5313034057617188, 3.0625534057617188,
                            3.0625534057617188, 3.0625534057617188, 3.0625534057617188, 3.0625534057617188,
                            3.0625534057617188, 0.7656784057617188, 1.5313034057617188, 1.5313034057617188,
                            1.5313034057617188, 1.5313034057617188, 1.5313034057617188, 1.5313034057617188,
                            0.38286590576171875, 0.38286590576171875, 0.38286590576171875, 0.38286590576171875,
                            0.38286590576171875, 0.38286590576171875, 0.38286590576171875, 0.09575653076171875,
                            0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                            0.01567840576171875, 0.01567840576171875]
        output_data_sizes = [0.1435546875, 12.250053405761719, 12.250053405761719, 12.250053405761719,
                             12.250053405761719, 3.0625534057617188, 6.125053405761719, 6.125053405761719,
                             6.125053405761719, 6.125053405761719, 1.5313034057617188, 3.0625534057617188,
                             3.0625534057617188, 3.0625534057617188, 3.0625534057617188, 3.0625534057617188,
                             3.0625534057617188, 0.7656784057617188, 1.5313034057617188, 1.5313034057617188,
                             1.5313034057617188, 1.5313034057617188, 1.5313034057617188, 1.5313034057617188,
                             0.38286590576171875, 0.38286590576171875, 0.38286590576171875, 0.38286590576171875,
                             0.38286590576171875, 0.38286590576171875, 0.38286590576171875, 0.09575653076171875,
                             0.09575653076171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                             0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.00386810302734375]
        input_shapes = [150528, 3211264, 3211264, 3211264, 3211264, 802816, 1605632, 1605632, 1605632, 1605632, 401408,
                        802816, 802816, 802816, 802816, 802816, 802816, 200704, 401408, 401408, 401408, 401408, 401408,
                        401408, 100352, 100352, 100352, 100352, 100352, 100352, 100352, 25088, 25088, 4096, 4096, 4096,
                        4096, 4096, 4096]
        output_shapes = [3211264, 3211264, 3211264, 3211264, 802816, 1605632, 1605632, 1605632, 1605632, 401408, 802816,
                         802816, 802816, 802816, 802816, 802816, 200704, 401408, 401408, 401408, 401408, 401408, 401408,
                         100352, 100352, 100352, 100352, 100352, 100352, 100352, 25088, 25088, 4096, 4096, 4096, 4096,
                         4096, 4096, 1000]
    elif imgSize == 300:
        input_data_sizes = [0.2574920654296875, 1.0300216674804688, 21.97270965576172, 21.97270965576172,
                            21.97270965576172, 21.97270965576172, 5.493217468261719, 10.986381530761719,
                            10.986381530761719, 10.986381530761719, 10.986381530761719, 2.7466354370117188,
                            5.493217468261719, 5.493217468261719, 5.493217468261719, 5.493217468261719,
                            5.493217468261719, 5.493217468261719, 1.3369674682617188, 2.6738815307617188,
                            2.6738815307617188, 2.6738815307617188, 2.6738815307617188, 2.6738815307617188,
                            2.6738815307617188, 0.6328659057617188, 0.6328659057617188, 0.6328659057617188,
                            0.6328659057617188, 0.6328659057617188, 0.6328659057617188, 0.6328659057617188,
                            0.09575653076171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                            0.01567840576171875, 0.01567840576171875, 0.01567840576171875]
        output_data_sizes = [0.2574920654296875, 21.97270965576172, 21.97270965576172, 21.97270965576172,
                             21.97270965576172, 5.493217468261719, 10.986381530761719, 10.986381530761719,
                             10.986381530761719, 10.986381530761719, 2.7466354370117188, 5.493217468261719,
                             5.493217468261719, 5.493217468261719, 5.493217468261719, 5.493217468261719,
                             5.493217468261719, 1.3369674682617188, 2.6738815307617188, 2.6738815307617188,
                             2.6738815307617188, 2.6738815307617188, 2.6738815307617188, 2.6738815307617188,
                             0.6328659057617188, 0.6328659057617188, 0.6328659057617188, 0.6328659057617188,
                             0.6328659057617188, 0.6328659057617188, 0.6328659057617188, 0.15825653076171875,
                             0.09575653076171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                             0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.00386810302734375]
        input_shapes = [270000, 5760000, 5760000, 5760000, 5760000, 1440000, 2880000, 2880000, 2880000, 2880000, 720000,
                        1440000, 1440000, 1440000, 1440000, 1440000, 1440000, 350464, 700928, 700928, 700928, 700928,
                        700928, 700928, 165888, 165888, 165888, 165888, 165888, 165888, 165888, 41472, 25088, 4096,
                        4096,
                        4096, 4096, 4096, 4096]
        output_shapes = [5760000, 5760000, 5760000, 5760000, 1440000, 2880000, 2880000, 2880000, 2880000, 720000,
                         1440000, 1440000, 1440000, 1440000, 1440000, 1440000, 350464, 700928, 700928, 700928, 700928,
                         700928, 700928, 165888, 165888, 165888, 165888, 165888, 165888, 165888, 41472, 25088, 4096,
                         4096, 4096, 4096, 4096, 4096, 1000]
    elif imgSize == 400:
        input_data_sizes = [0.457763671875, 1.8311080932617188, 39.06255340576172, 39.06255340576172, 39.06255340576172,
                            39.06255340576172, 9.765678405761719, 19.53130340576172, 19.53130340576172,
                            19.53130340576172, 19.53130340576172, 4.882865905761719, 9.765678405761719,
                            9.765678405761719, 9.765678405761719, 9.765678405761719, 9.765678405761719,
                            9.765678405761719, 2.4414596557617188, 4.882865905761719, 4.882865905761719,
                            4.882865905761719, 4.882865905761719, 4.882865905761719, 4.882865905761719,
                            1.2207565307617188, 1.2207565307617188, 1.2207565307617188, 1.2207565307617188,
                            1.2207565307617188, 1.2207565307617188, 1.2207565307617188, 0.09575653076171875,
                            0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                            0.01567840576171875, 0.01567840576171875]
        output_data_sizes = [0.457763671875, 39.06255340576172, 39.06255340576172, 39.06255340576172, 39.06255340576172,
                             9.765678405761719, 19.53130340576172, 19.53130340576172, 19.53130340576172,
                             19.53130340576172, 4.882865905761719, 9.765678405761719, 9.765678405761719,
                             9.765678405761719, 9.765678405761719, 9.765678405761719, 9.765678405761719,
                             2.4414596557617188, 4.882865905761719, 4.882865905761719, 4.882865905761719,
                             4.882865905761719, 4.882865905761719, 4.882865905761719, 1.2207565307617188,
                             1.2207565307617188, 1.2207565307617188, 1.2207565307617188, 1.2207565307617188,
                             1.2207565307617188, 1.2207565307617188, 0.28130340576171875, 0.09575653076171875,
                             0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                             0.01567840576171875, 0.01567840576171875, 0.00386810302734375]
        input_shapes = [480000, 10240000, 10240000, 10240000, 10240000, 2560000, 5120000, 5120000, 5120000, 5120000,
                        1280000, 2560000, 2560000, 2560000, 2560000, 2560000, 2560000, 640000, 1280000, 1280000,
                        1280000,
                        1280000, 1280000, 1280000, 320000, 320000, 320000, 320000, 320000, 320000, 320000, 73728, 25088,
                        4096, 4096, 4096, 4096, 4096, 4096]
        output_shapes = [10240000, 10240000, 10240000, 10240000, 2560000, 5120000, 5120000, 5120000, 5120000, 1280000,
                         2560000, 2560000, 2560000, 2560000, 2560000, 2560000, 640000, 1280000, 1280000, 1280000,
                         1280000, 1280000, 1280000, 320000, 320000, 320000, 320000, 320000, 320000, 320000, 73728,
                         25088,
                         4096, 4096, 4096, 4096, 4096, 4096, 1000]

    elif imgSize == 500:
        input_data_sizes = [0.7152557373046875, 2.8610763549804688, 61.03520965576172, 61.03520965576172,
                            61.03520965576172, 61.03520965576172, 15.258842468261719, 30.51763153076172,
                            30.51763153076172, 30.51763153076172, 30.51763153076172, 7.629447937011719,
                            15.258842468261719, 15.258842468261719, 15.258842468261719, 15.258842468261719,
                            15.258842468261719, 15.258842468261719, 3.7539596557617188, 7.507865905761719,
                            7.507865905761719, 7.507865905761719, 7.507865905761719, 7.507865905761719,
                            7.507865905761719, 1.8770065307617188, 1.8770065307617188, 1.8770065307617188,
                            1.8770065307617188, 1.8770065307617188, 1.8770065307617188, 1.8770065307617188,
                            0.09575653076171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                            0.01567840576171875, 0.01567840576171875, 0.01567840576171875]
        output_data_sizes = [0.7152557373046875, 61.03520965576172, 61.03520965576172, 61.03520965576172,
                             61.03520965576172, 15.258842468261719, 30.51763153076172, 30.51763153076172,
                             30.51763153076172, 30.51763153076172, 7.629447937011719, 15.258842468261719,
                             15.258842468261719, 15.258842468261719, 15.258842468261719, 15.258842468261719,
                             15.258842468261719, 3.7539596557617188, 7.507865905761719, 7.507865905761719,
                             7.507865905761719, 7.507865905761719, 7.507865905761719, 7.507865905761719,
                             1.8770065307617188, 1.8770065307617188, 1.8770065307617188, 1.8770065307617188,
                             1.8770065307617188, 1.8770065307617188, 1.8770065307617188, 0.43950653076171875,
                             0.09575653076171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                             0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.00386810302734375]
        input_shapes = [750000, 16000000, 16000000, 16000000, 16000000, 4000000, 8000000, 8000000, 8000000, 8000000,
                        2000000, 4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 984064, 1968128, 1968128,
                        1968128,
                        1968128, 1968128, 1968128, 492032, 492032, 492032, 492032, 492032, 492032, 492032, 115200,
                        25088,
                        4096, 4096, 4096, 4096, 4096, 4096]
        output_shapes = [16000000, 16000000, 16000000, 16000000, 4000000, 8000000, 8000000, 8000000, 8000000, 2000000,
                         4000000, 4000000, 4000000, 4000000, 4000000, 4000000, 984064, 1968128, 1968128, 1968128,
                         1968128, 1968128, 1968128, 492032, 492032, 492032, 492032, 492032, 492032, 492032, 115200,
                         25088, 4096, 4096, 4096, 4096, 4096, 4096, 1000]

    elif imgSize == 640:
        input_data_sizes = [1.171875, 4.687553405761719, 100.00005340576172, 100.00005340576172, 100.00005340576172,
                            100.00005340576172, 25.00005340576172, 50.00005340576172, 50.00005340576172,
                            50.00005340576172, 50.00005340576172, 12.500053405761719, 25.00005340576172,
                            25.00005340576172, 25.00005340576172, 25.00005340576172, 25.00005340576172,
                            25.00005340576172, 6.250053405761719, 12.500053405761719, 12.500053405761719,
                            12.500053405761719, 12.500053405761719, 12.500053405761719, 12.500053405761719,
                            3.1250534057617188, 3.1250534057617188, 3.1250534057617188, 3.1250534057617188,
                            3.1250534057617188, 3.1250534057617188, 3.1250534057617188, 0.09575653076171875,
                            0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                            0.01567840576171875, 0.01567840576171875]
        output_data_sizes = [1.171875, 100.00005340576172, 100.00005340576172, 100.00005340576172, 100.00005340576172,
                             25.00005340576172, 50.00005340576172, 50.00005340576172, 50.00005340576172,
                             50.00005340576172, 12.500053405761719, 25.00005340576172, 25.00005340576172,
                             25.00005340576172, 25.00005340576172, 25.00005340576172, 25.00005340576172,
                             6.250053405761719, 12.500053405761719, 12.500053405761719, 12.500053405761719,
                             12.500053405761719, 12.500053405761719, 12.500053405761719, 3.1250534057617188,
                             3.1250534057617188, 3.1250534057617188, 3.1250534057617188, 3.1250534057617188,
                             3.1250534057617188, 3.1250534057617188, 0.7813034057617188, 0.09575653076171875,
                             0.01567840576171875, 0.01567840576171875, 0.01567840576171875, 0.01567840576171875,
                             0.01567840576171875, 0.01567840576171875, 0.00386810302734375]
        input_shapes = [1228800, 26214400, 26214400, 26214400, 26214400, 6553600, 13107200, 13107200, 13107200,
                        13107200,
                        3276800, 6553600, 6553600, 6553600, 6553600, 6553600, 6553600, 1638400, 3276800, 3276800,
                        3276800, 3276800, 3276800, 3276800, 819200, 819200, 819200, 819200, 819200, 819200, 819200,
                        204800, 25088, 4096, 4096, 4096, 4096, 4096, 4096]
        output_shapes = [26214400, 26214400, 26214400, 26214400, 6553600, 13107200, 13107200, 13107200, 13107200,
                         3276800, 6553600, 6553600, 6553600, 6553600, 6553600, 6553600, 1638400, 3276800, 3276800,
                         3276800, 3276800, 3276800, 3276800, 819200, 819200, 819200, 819200, 819200, 819200, 819200,
                         204800, 25088, 4096, 4096, 4096, 4096, 4096, 4096, 1000]

    else:
        input_data_sizes, output_data_sizes, input_shapes, output_shapes = [], [], [], []

    return input_data_sizes, output_data_sizes, input_shapes, output_shapes
